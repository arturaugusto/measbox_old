<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Measbox - <%= controller_name.singularize.humanize + " " + action_name.humanize %> </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <%= javascript_include_tag "https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js", "https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js" %>
  <![endif]-->

  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

  <%#= mathjax_tag %>
</head>
<body class='<%= if not ((controller_name == "reports") and (action_name == "show")) then "body_do_padding" else "body_dont_do_padding" end %>'>
  <% if not ((controller_name == "reports") and (action_name == "show")) then %>
    <!--<div class="navbar navbar-inverse navbar-fixed-top">-->
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <%= if current_laboratory != nil then (link_to(current_laboratory.name, edit_laboratory_path(current_laboratory), :class => "navbar-brand")) else (link_to(raw("Measbox <sub>beta</sub>"), "#", :class => "navbar-brand")) end %>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <% if user_signed_in? %>
              
              <%= content_tag(:li, link_to("Services", services_path), class: "#{ controller_name=="services"? "active" : "" }" ) %>

              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Instrumentation <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                  
                  <%= content_tag(:li, link_to("Assets", assets_path), class: "#{ controller_name=="assets"? "active" : "" }" ) %>
                  
                  <%= content_tag(:li, link_to("Models", models_path), class: "#{ controller_name=="models"? "active" : "" }" ) %>

                  <%= content_tag(:li, link_to("Manufacturers", manufacturers_path), class: "#{ controller_name=="manufacturers"? "active" : "" }" ) %>
                  
                  <%= content_tag(:li, link_to("Types", kinds_path), class: "#{ controller_name=="kinds"? "active" : "" }" ) %>
                </ul>
              </li>

              <%= content_tag(:li, link_to("Templates", snippets_path), class: "#{ controller_name=="snippets"? "active" : "" }" ) %>
            <% end %>
            <% if user_signed_in? %>
              <%= content_tag(:li, link_to( content_tag(:i, "", class: "glyphicon glyphicon-user") + " " +current_user.email, edit_user_path(current_user) ), class: "#{ (controller_name=="users" and current_user.id == params[:id])? "active" : "" }" ) %>
              <li><%= link_to content_tag(:i, "", class: "glyphicon glyphicon-off") + ' Sign out', destroy_user_session_path, :method=>'delete' %></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-cog"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <%= content_tag(:li, link_to("Report Templates", report_templates_path), class: "#{ controller_name=="report_templates"? "active" : "" }" ) %>              
                  <%= content_tag(:li, link_to("Users", users_path), class: "#{ (controller_name=="users" and current_user.id != params[:id])? "active" : "" }" ) %>
                  <%= content_tag(:li, link_to("Companies", companies_path), class: "#{ controller_name=="companies"? "active" : "" }" ) %>
                  <%= content_tag(:li, link_to("Roles", roles_path), class: "#{ controller_name=="roles"? "active" : "" }" ) %>
                </ul>
              </li>
            <% else %>
              <% if current_laboratory != nil then %>
                <%= content_tag(:li, link_to("Sign in", new_user_session_path), class: "#{ controller_name=="sessions"? "active" : "" }" ) %>
                <%= content_tag(:li, link_to("Sign up", new_user_registration_path), class: "#{ controller_name=="registrations"? "active" : "" }" ) %>
              <% else %>
                <%#= content_tag(:li, link_to("None", "#"), class: "" ) %>
              <% end %>
            <% end %>
          </ul>
        </div>
      </div>      
    </div>
  
    <% if current_laboratory == nil then %>
      <div class="bg"></div>
      <div class="jumbotron hello_intro">
        <div class="container">
          <h3>Empowering Laboratories.</h3>
          <p>Automating tests and measurements.</p>
        </div>
      </div>
    <% end %>
  <% end %>

  <div class="container">
    <div id="flash_messages">
      <% flash.each do |name, msg|
        if msg.class == String # regular flash notices, alerts, etc. will be strings
          msg = [msg]
        end

        msg.each do |msg| %>
          <%= content_tag :div, :class => "alert alert-#{ name=="error"? "danger" : "info" } alert-dismissable" do %>
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <%= msg %>
          <% end %>  
        <% end %>
      <% end %>
    </div><!-- flash_messages -->
    <%= yield %>
  </div>
</body>
</html>
